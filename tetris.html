<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Tetris - HTML/CSS/JavaScript</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1724;
      --accent:#00e0ff;
      --muted:#8b9bb0;
      --cell-size:28px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#071021 0%, #0b1220 100%);color:#dce8f2;touch-action: manipulation;}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:16px}
    .game {display:flex;gap:16px;align-items:start;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.03));padding:14px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.6);}
    .board-card{background:var(--panel);padding:12px;border-radius:8px}
    .screen{background:#071126;border-radius:6px;padding:8px;display:inline-block}
    canvas{display:block;background:linear-gradient(180deg,#07112a,#071126);border-radius:4px;max-width:100%;height:auto}
    .side{width:200px;display:flex;flex-direction:column;gap:10px}
    .info{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:10px;border-radius:8px}
    .info h3{margin:0 0 6px 0;font-size:14px;color:var(--accent)}
    .info p{margin:0;color:var(--muted);font-size:13px}
    .next{height:100px;display:flex;align-items:center;justify-content:center}
    .controls{font-size:13px;color:var(--muted);line-height:1.6}
    .footer{font-size:12px;color:#7f95aa}
    .big{font-size:20px;font-weight:700;color:#fff;margin:4px 0}
    .small{font-size:12px;color:var(--muted)}
    .btn{display:inline-block;padding:6px 10px;border-radius:6px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.02);cursor:pointer;font-size:13px;text-align:center;user-select:none}
    @media (max-width:720px){
      .game{flex-direction:column;align-items:center}
      .side{width:100%;flex-direction:row;flex-wrap:wrap;justify-content:center}
    }
    .touch-controls{display:flex;justify-content:center;gap:8px;margin-top:10px}
    .touch-controls .btn{flex:1;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="game">
      <div class="board-card">
        <div class="screen">
          <canvas id="board" width="280" height="500"></canvas>
        </div>
        <div class="touch-controls">
          <div class="btn" id="left">←</div>
          <div class="btn" id="rotate">↑</div>
          <div class="btn" id="right">→</div>
          <div class="btn" id="soft">↓</div>
          <div class="btn" id="hard">Space</div>
        </div>
      </div>

      <div class="side">
        <div class="info">
          <h3>TETRIS</h3>
          <div>Score</div>
          <div class="big" id="score">0</div>
          <div class="small">Level: <span id="level">1</span></div>
          <div class="small">Lines: <span id="lines">0</span></div>
        </div>

        <div class="info">
          <h3>Next</h3>
          <div class="next"><canvas id="next" width="120" height="120"></canvas></div>
        </div>

        <div class="info controls">
          <h3>Controles</h3>
          <p>← → : Mover</p>
          <p>↑ : Rotar</p>
          <p>↓ : Soft drop</p>
          <p>Space : Hard drop</p>
          <p>P : Pausa</p>
        </div>

        <div style="display:flex;gap:6px;flex-wrap:wrap;justify-content:center">
          <div class="btn" id="btnStart">Iniciar / Reiniciar</div>
          <div class="btn" id="btnPause">Pausa</div>
        </div>

        <div class="footer">Creado con HTML · CSS · JavaScript</div>
      </div>
    </div>
  </div>

  <script>
  // Código base de Tetris (misma lógica que antes) ...

  const COLS = 10, ROWS = 18; // altura reducida
  const CELL = 28;
  const COLORS = {0:'#071126', I:'#00e0ff', J:'#0057ff', L:'#ff8c00', O:'#ffd400', S:'#00c853', T:'#a000ff', Z:'#ff2d55'};
  const SHAPES = {I:[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]]],J:[[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],L:[[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],O:[[[1,1],[1,1]]],S:[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]]],T:[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],Z:[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]]]};
  const BAG = ['I','J','L','O','S','T','Z'];

  const boardCanvas = document.getElementById('board');
  const ctx = boardCanvas.getContext('2d');
  const nextCanvas = document.getElementById('next');
  const nctx = nextCanvas.getContext('2d');
  boardCanvas.width = COLS*CELL; boardCanvas.height = ROWS*CELL;
  nextCanvas.width = 4*CELL; nextCanvas.height = 4*CELL;

  let board = Array.from({length:ROWS},()=>Array(COLS).fill(0));
  let current=null,nextPiece=null,bagArr=[],dropCounter=0,dropInterval=800,lastTime=0,score=0,lines=0,level=1,running=false,paused=false;

  function drawCell(x,y,color){ctx.fillStyle=color;ctx.fillRect(x*CELL+1,y*CELL+1,CELL-2,CELL-2);ctx.strokeStyle='rgba(255,255,255,0.06)';ctx.strokeRect(x*CELL+1,y*CELL+1,CELL-2,CELL-2);}
  function draw(){ctx.fillStyle='#071126';ctx.fillRect(0,0,boardCanvas.width,boardCanvas.height);
    for(let y=0;y<ROWS;y++){for(let x=0;x<COLS;x++){drawCell(x,y,board[y][x]?COLORS[board[y][x]]:'rgba(255,255,255,0.01)');}}
    if(current){const s=current.shape;for(let y=0;y<s.length;y++)for(let x=0;x<s[y].length;x++)if(s[y][x])drawCell(current.x+x,current.y+y,COLORS[current.type]);}}
  function drawNext(){nctx.fillStyle='#071126';nctx.fillRect(0,0,nextCanvas.width,nextCanvas.height);if(!nextPiece)return;
    const s=nextPiece.shape,trows=s.length,tcols=s[0].length;
    const offsetX=Math.floor((4-tcols)/2),offsetY=Math.floor((4-trows)/2);
    for(let y=0;y<trows;y++)for(let x=0;x<tcols;x++)if(s[y][x]){nctx.fillStyle=COLORS[nextPiece.type];nctx.fillRect((x+offsetX)*CELL+6,(y+offsetY)*CELL+6,CELL-12,CELL-12);}}

  function rotate(m){const N=m.length,res=Array.from({length:N},()=>Array(N).fill(0));for(let y=0;y<N;y++)for(let x=0;x<N;x++)res[x][N-1-y]=m[y][x];return res;}
  function collide(m,pos){for(let y=0;y<m.length;y++)for(let x=0;x<m[y].length;x++)if(m[y][x]){const bx=pos.x+x,by=pos.y+y;if(bx<0||bx>=COLS||by>=ROWS)return true;if(by>=0&&board[by][bx])return true;}return false;}
  function merge(m,pos,type){for(let y=0;y<m.length;y++)for(let x=0;x<m[y].length;x++)if(m[y][x]&&pos.y+y>=0)board[pos.y+y][pos.x+x]=type;}
  function clearLines(){let rc=0;for(let y=ROWS-1;y>=0;y--){if(board[y].every(v=>v!==0)){board.splice(y,1);board.unshift(Array(COLS).fill(0));rc++;y++;}}if(rc>0){lines+=rc;score+=(rc===1?100:rc===2?300:rc===3?500:800)*level;level=Math.floor(lines/10)+1;dropInterval=Math.max(60,800-(level-1)*60);document.getElementById('score').textContent=score;document.getElementById('lines').textContent=lines;document.getElementById('level').textContent=level;}}

  function nextFromBag(){if(bagArr.length===0)bagArr=shuffle(BAG.slice());const type=bagArr.pop();return {type,rotations:SHAPES[type]};}
  function spawnPiece(){if(!nextPiece)nextPiece=makePiece(nextFromBag());current=nextPiece;current.x=Math.floor((COLS-current.shape[0].length)/2);current.y=-Math.max(0,current.shape.length-2);nextPiece=makePiece(nextFromBag());drawNext();if(collide(current.shape,current)){running=false;alert('Game Over\nScore: '+score);}}
  function makePiece(spec){return {type:spec.type,rotations:spec.rotations,rotIndex:0,shape:spec.rotations[0].map(r=>r.slice()),x:0,y:0};}
  function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

  // Controles touch
  document.getElementById('left').addEventListener('touchstart',()=>move(-1));
  document.getElementById('right').addEventListener('touchstart',()=>move(1));
  document.getElementById('rotate').addEventListener('touchstart',()=>rotatePiece());
  document.getElementById('soft').addEventListener('touchstart',()=>softDrop());
  document.getElementById('hard').addEventListener('touchstart',()=>hardDrop());

  document.addEventListener('keydown',e=>{if(!running)return;if(e.key==='ArrowLeft')move(-1);else if(e.key==='ArrowRight')move(1);else if(e.key==='ArrowDown')softDrop();else if(e.key==='ArrowUp')rotatePiece();else if(e.code==='Space'){hardDrop();e.preventDefault();}else if(e.key.toLowerCase()==='p')togglePause();});
  document.getElementById('btnStart').addEventListener('click',startGame);
  document.getElementById('btnPause').addEventListener('click',togglePause);

  function move(dir){current.x+=dir;if(collide(current.shape,current))current.x-=dir;}
  function rotatePiece(){const nextRot=(current.rotIndex+1)%current.rotations.length;const newShape=current.rotations[nextRot];const oldX=current.x,oldY=current.y;const kicks=[0,-1,1,-2,2];for(const k of kicks){current.x=oldX+k;if(!collide(newShape,current)){current.rotIndex=nextRot;current.shape=newShape.map(r=>r.slice());return;}}current.x=oldX;current.y=oldY;}
  function softDrop(){current.y++;if(collide(current.shape,current)){current.y--;lockPiece();}else{score+=1;document.getElementById('score').textContent=score;}}
  function hardDrop(){while(!collide(current.shape,current)){current.y++;score+=2;}current.y--;lockPiece();document.getElementById('score').textContent=score;}
  function lockPiece(){merge(current.shape,{x:current.x,y:current.y},current.type);clearLines();spawnPiece();}
  function togglePause(){paused=!paused;document.getElementById('btnPause').textContent=paused?'Reanudar':'Pausa';}
  function update(time=0){const delta=time-lastTime;lastTime=time;if(running&&!paused){dropCounter+=delta;if(dropCounter>dropInterval){current.y++;if(collide(current.shape,current)){current.y--;lockPiece();}dropCounter=0;}draw();}requestAnimationFrame(update);}
  function startGame(){board=Array.from({length:ROWS},()=>Array(COLS).fill(0));bagArr=shuffle(BAG.slice());nextPiece=makePiece(nextFromBag());current=null;score=0;lines=0;level=1;dropInterval=800;running=true;paused=false;document.getElementById('score').textContent=score;document.getElementById('lines').textContent=lines;document.getElementById('level').textContent=level;document.getElementById('btnPause').textContent='Pausa';spawnPiece();lastTime=performance.now();requestAnimationFrame(update);}
  draw();drawNext();
  </script>
</body>
</html>
